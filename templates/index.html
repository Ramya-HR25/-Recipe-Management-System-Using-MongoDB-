<!DOCTYPE html>
<html>
<head>
    <title>Recipe Management System</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>
    <div class="container">
        <header>
            <h1>üç≥ Recipe Management System</h1>
            <p>Store and manage your favorite recipes</p>
        </header>

        <section class="add-recipe-section">
            <h2>Add New Recipe</h2>
            <form id="add-recipe-form" action="/add" method="POST">
                <div class="form-group">
                    <label for="name">Recipe Name:</label>
                    <input type="text" id="name" name="name" placeholder="Enter recipe name" required>
                </div>
                
                <div class="form-group">
                    <label for="ingredients">Ingredients:</label>
                    <textarea id="ingredients" name="ingredients" placeholder="List ingredients (one per line)" required></textarea>
                </div>
                
                <div class="form-group">
                    <label for="steps">Preparation Steps:</label>
                    <textarea id="steps" name="steps" placeholder="Describe preparation steps" required></textarea>
                </div>
                
                <button type="submit" class="btn btn-primary">Add Recipe</button>
            </form>
        </section>

        <section class="recipes-section">
            <h2>Available Recipes</h2>
            <div id="recipes-container">
                {% if recipes %}
                    {% for r in recipes %}
                        <div class="recipe-card" data-id="{{ r._id }}">
                            <div class="recipe-header">
                                <h3 class="recipe-title">{{ r.name }}</h3>
                                <div class="recipe-actions">
                                    <button class="btn btn-edit" onclick="editRecipe('{{ r._id }}')">Edit</button>
                                    <button class="btn btn-delete" onclick="deleteRecipe('{{ r._id }}')">Delete</button>
                                </div>
                            </div>
                            
                            <div class="recipe-content">
                                <div class="recipe-details">
                                    <h4>Ingredients:</h4>
                                    <pre class="ingredients-text">{{ r.ingredients }}</pre>
                                </div>
                                
                                <div class="recipe-details">
                                    <h4>Preparation Steps:</h4>
                                    <pre class="steps-text">{{ r.steps }}</pre>
                                </div>
                            </div>
                            
                            <div class="edit-form" id="edit-form-{{ r._id }}" style="display: none;">
                                <form action="/update/{{ r._id }}" method="POST">
                                    <div class="form-group">
                                        <label for="edit-name-{{ r._id }}">Recipe Name:</label>
                                        <input type="text" id="edit-name-{{ r._id }}" name="name" value="{{ r.name }}" required>
                                    </div>
                                    
                                    <div class="form-group">
                                        <label for="edit-ingredients-{{ r._id }}">Ingredients:</label>
                                        <textarea id="edit-ingredients-{{ r._id }}" name="ingredients" required>{{ r.ingredients }}</textarea>
                                    </div>
                                    
                                    <div class="form-group">
                                        <label for="edit-steps-{{ r._id }}">Preparation Steps:</label>
                                        <textarea id="edit-steps-{{ r._id }}" name="steps" required>{{ r.steps }}</textarea>
                                    </div>
                                    
                                    <button type="submit" class="btn btn-primary">Save Changes</button>
                                    <button type="button" class="btn btn-secondary" onclick="cancelEdit('{{ r._id }}')">Cancel</button>
                                </form>
                            </div>
                        </div>
                    {% endfor %}
                {% else %}
                    <div class="no-recipes">
                        <p>No recipes found. Add your first recipe above!</p>
                    </div>
                {% endif %}
            </div>
        </section>
    </div>

    <script>
        // Handle form submission with confirmation
        document.getElementById('add-recipe-form').addEventListener('submit', function(e) {
            const name = document.getElementById('name').value;
            if (!name.trim()) {
                e.preventDefault();
                alert('Please enter a recipe name');
                return;
            }
            
            // Show success message
            console.log('Adding recipe:', name);
        });

        // Edit recipe function
        function editRecipe(id) {
            // Hide all edit forms
            document.querySelectorAll('.edit-form').forEach(form => {
                form.style.display = 'none';
            });
            
            // Show the edit form for this recipe
            const editForm = document.getElementById('edit-form-' + id);
            if (editForm) {
                editForm.style.display = 'block';
                
                // Scroll to the form
                editForm.scrollIntoView({ behavior: 'smooth' });
            }
        }

        // Cancel edit function
        function cancelEdit(id) {
            const editForm = document.getElementById('edit-form-' + id);
            if (editForm) {
                editForm.style.display = 'none';
            }
        }

        // Delete recipe function with confirmation
        function deleteRecipe(id) {
            if (confirm('Are you sure you want to delete this recipe?')) {
                window.location.href = '/delete/' + id;
            }
        }

        // Add some basic animations
        document.addEventListener('DOMContentLoaded', function() {
            const recipeCards = document.querySelectorAll('.recipe-card');
            recipeCards.forEach((card, index) => {
                // Add a slight delay for each card animation
                card.style.opacity = '0';
                card.style.transform = 'translateY(20px)';
                
                setTimeout(() => {
                    card.style.transition = 'opacity 0.5s ease, transform 0.5s ease';
                    card.style.opacity = '1';
                    card.style.transform = 'translateY(0)';
                }, 100 * index);
            });
        });
    </script>
</body>
</html>